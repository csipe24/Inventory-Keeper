const router=require("express").Router(),db=require("../models/index");router.get("/",(a,b)=>{console.log("Read Items"),db.Item.findAll({include:[{model:db.Category}]}).then(a=>{b.render("index",{items:JSON.parse(JSON.stringify(a))})})}),router.get("/api/items",(a,b)=>{console.log("Read all items"),db.Item.findAll({include:[{model:db.Category}]}).then(a=>{b.json(a)})}),router.get("/api/items/:id",(a,b)=>{console.log("Read one item "),db.Item.findOne({include:[{model:db.Category}],where:{id:a.params.id}}).then(a=>{b.json(a)})}),router.post("/api/items",(a,b)=>{console.log("Create Items"),console.log(a.body),console.log(a.body.item),db.Item.create(a.body).then(a=>{b.json(a)})}),router.delete("/api/items/:id",(a,b)=>{console.log("Delete Items"),db.Item.destroy({where:{id:a.params.id}}).then(()=>{b.end()})}),router.put("/api/items/:id",(a,b)=>{db.Item.update({item:a.body.item,quantity:a.body.quantity,cost:a.body.cost,CategoryId:a.body.CategoryId},{where:{id:a.params.id}}).then(a=>{0===a[0]?b.status(404).end():b.status(200).end()})}),router.get("/api/categories",(a,b)=>{console.log("Read categories"),db.Category.findAll({}).then(a=>{b.json(a)})}),router.post("/api/categories",(a,b)=>{console.log("Create categories"),console.log(a.body),console.log(a.body.item),db.Category.create({category:a.body.category}).then(a=>{b.json(a)})}),router.delete("/api/categories/:id",(a,b)=>{console.log("Delete categories"),db.Category.destroy({where:{id:a.params.id}}).then(()=>{b.end()})}),router.put("/api/categories/:id",(a,b)=>{db.Category.update({category:a.body.category},{where:{id:a.params.id}}).then(a=>{0===a[0]?b.status(404).end():b.status(200).end()})}),router.get("/api/charts",(a,b)=>{console.log("New Route"),db.Category.findAll({include:db.Item}).then(a=>{b.json(a)})}),module.exports=router;